{
  "info": {
    "name": "Admin API (v1)",
    "description": "Postman collection for Admin API (v1) - Auth, RBAC, Catalog",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000"
    },
    {
      "key": "admin_token",
      "value": ""
    },
    {
      "key": "category_id",
      "value": ""
    },
    {
      "key": "subcategory_id",
      "value": ""
    },
    {
      "key": "brand_id",
      "value": ""
    },
    {
      "key": "place_id",
      "value": ""
    },
    {
      "key": "branch_id",
      "value": ""
    },
    {
      "key": "criteria_id",
      "value": ""
    },
    {
      "key": "choice_id",
      "value": ""
    },
    {
      "key": "from",
      "value": ""
    },
    {
      "key": "to",
      "value": ""
    },
    {
      "key": "role_id",
      "value": ""
    }
  ],
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Login",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Accept", "value": "application/json" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{\n  \"email\": \"admin@example.com\",\n  \"password\": \"password\"\n}" },
            "url": { "raw": "{{base_url}}/api/v1/admin/auth/login", "host": ["{{base_url}}"], "path": ["api","v1","admin","auth","login"] },
            "description": "Admin login - saves token to {{admin_token}}"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200', function () { pm.response.to.have.status(200); });",
                  "var json = {}; try { json = pm.response.json(); } catch(e) {}",
                  "var token = json.token || json.access_token || (json.data && (json.data.token || json.data.access_token));",
                  "if (!token) {",
                  "  function findToken(obj) { if (!obj || typeof obj !== 'object') return null; if (obj.token) return obj.token; if (obj.access_token) return obj.access_token; for (var k in obj) { if (obj.hasOwnProperty(k) && typeof obj[k] === 'object') { var t = findToken(obj[k]); if (t) return t; } } return null; }",
                  "  token = findToken(json);",
                  "}",
                  "if (token) { pm.collectionVariables.set('admin_token', token); }"]
              }
            }
          ]
        },
        {
          "name": "05-Users Management",
          "item": [
            {
              "name": "List Users",
              "request": {
                "method": "GET",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "url": { "raw": "{{base_url}}/api/v1/admin/users", "host": ["{{base_url}}"], "path": ["api","v1","admin","users"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Response shape', function(){ pm.expect(json).to.have.property('success'); pm.expect(json).to.have.property('data'); pm.expect(json).to.have.property('meta'); });"] } }]
            },
            {
              "name": "Get User Details",
              "request": {
                "method": "GET",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "url": { "raw": "{{base_url}}/api/v1/admin/users/{{admin_user_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","users","{{admin_user_id}}"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "Block User",
              "request": {
                "method": "POST",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "body": { "mode": "raw", "raw": "{\n  \"is_blocked\": true,\n  \"reason\": \"Violation\"\n}" },
                "url": { "raw": "{{base_url}}/api/v1/admin/users/{{admin_user_id}}/block", "host": ["{{base_url}}"], "path": ["api","v1","admin","users","{{admin_user_id}}","block"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "Unblock User",
              "request": {
                "method": "POST",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "body": { "mode": "raw", "raw": "{\n  \"is_blocked\": false\n}" },
                "url": { "raw": "{{base_url}}/api/v1/admin/users/{{admin_user_id}}/block", "host": ["{{base_url}}"], "path": ["api","v1","admin","users","{{admin_user_id}}","block"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "Get User Reviews",
              "request": {
                "method": "GET",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "url": { "raw": "{{base_url}}/api/v1/admin/users/{{admin_user_id}}/reviews", "host": ["{{base_url}}"], "path": ["api","v1","admin","users","{{admin_user_id}}","reviews"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "Get User Points",
              "request": {
                "method": "GET",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "url": { "raw": "{{base_url}}/api/v1/admin/users/{{admin_user_id}}/points", "host": ["{{base_url}}"], "path": ["api","v1","admin","users","{{admin_user_id}}","points"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            }
          ]
        },
        {
          "name": "Me",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Accept", "value": "application/json" },
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{admin_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/admin/auth/me", "host": ["{{base_url}}"], "path": ["api","v1","admin","auth","me"] },
            "description": "Get current admin profile (protected)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Accept", "value": "application/json" },
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{admin_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/admin/auth/logout", "host": ["{{base_url}}"], "path": ["api","v1","admin","auth","logout"] },
            "description": "Logout admin (protected)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        }
      ]
    },
    {
      "name": "10-Dashboard",
      "item": [
        {
          "name": "GET Summary (all-time)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/dashboard/summary", "host": ["{{base_url}}"], "path": ["api","v1","admin","dashboard","summary"] },
            "description": "Get dashboard KPIs (all-time)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Response shape', function(){ pm.expect(json).to.have.property('success'); pm.expect(json.success).to.equal(true); pm.expect(json).to.have.property('data'); });","pm.test('Summary fields', function(){ pm.expect(json.data).to.have.property('users_count'); pm.expect(json.data).to.have.property('reviews_count'); pm.expect(json.data).to.have.property('avg_rating'); pm.expect(json.data).to.have.property('points_issued_total'); pm.expect(json.data).to.have.property('points_redeemed_total'); });"] } }]
        },
        {
          "name": "GET Summary (date range)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/dashboard/summary?from={{from}}&to={{to}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","dashboard","summary"], "query": [ {"key": "from", "value": "{{from}}"}, {"key": "to", "value": "{{to}}"} ] },
            "description": "Get dashboard KPIs for date range (from/to: YYYY-MM-DD)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Has meta with dates', function(){ pm.expect(json).to.have.property('meta'); });"] } }]
        },
        {
          "name": "GET Top Places (default limit=10)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/dashboard/top-places", "host": ["{{base_url}}"], "path": ["api","v1","admin","dashboard","top-places"] },
            "description": "Get top places by reviews count (default)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Response is array', function(){ pm.expect(json.data).to.be.an('array'); });","pm.test('Place fields', function(){ if(json.data.length > 0){ var p = json.data[0]; pm.expect(p).to.have.property('place'); pm.expect(p).to.have.property('reviews_count'); pm.expect(p).to.have.property('avg_rating'); pm.expect(p).to.have.property('points_issued'); }});"] } }]
        },
        {
          "name": "GET Top Places (metric=avg_rating)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/dashboard/top-places?metric=avg_rating&limit=5", "host": ["{{base_url}}"], "path": ["api","v1","admin","dashboard","top-places"], "query": [ {"key": "metric", "value": "avg_rating"}, {"key": "limit", "value": "5"} ] },
            "description": "Get top places ranked by avg_rating, limit 5"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Has data array', function(){ pm.expect(json.data).to.be.an('array'); pm.expect(json.data.length).to.be.at.most(5); });"] } }]
        },
        {
          "name": "GET Top Places (category filter)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/dashboard/top-places?category_id=1&limit=10", "host": ["{{base_url}}"], "path": ["api","v1","admin","dashboard","top-places"], "query": [ {"key": "category_id", "value": "1"}, {"key": "limit", "value": "10"} ] },
            "description": "Get top places filtered by category"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        },
        {
          "name": "GET Reviews Chart (interval=auto)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/dashboard/reviews-chart?from=2026-01-01&to=2026-01-31", "host": ["{{base_url}}"], "path": ["api","v1","admin","dashboard","reviews-chart"], "query": [ {"key": "from", "value": "2026-01-01"}, {"key": "to", "value": "2026-01-31"} ] },
            "description": "Get reviews timeseries (interval auto-selected based on date range)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Chart shape', function(){ pm.expect(json.data).to.have.property('interval'); pm.expect(json.data).to.have.property('from'); pm.expect(json.data).to.have.property('to'); pm.expect(json.data).to.have.property('series'); pm.expect(json.data.series).to.be.an('array'); });","pm.test('Series data fields', function(){ if(json.data.series.length > 0){ var s = json.data.series[0]; pm.expect(s).to.have.property('date'); pm.expect(s).to.have.property('reviews_count'); pm.expect(s).to.have.property('avg_rating'); }});"] } }]
        },
        {
          "name": "GET Reviews Chart (interval=week)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/dashboard/reviews-chart?from=2025-12-01&to=2026-01-31&interval=week", "host": ["{{base_url}}"], "path": ["api","v1","admin","dashboard","reviews-chart"], "query": [ {"key": "from", "value": "2025-12-01"}, {"key": "to", "value": "2026-01-31"}, {"key": "interval", "value": "week"} ] },
            "description": "Get reviews timeseries grouped by week"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Interval is week', function(){ pm.expect(json.data.interval).to.equal('week'); });"] } }]
        },
        {
          "name": "GET Reviews Chart (place_id filter)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/dashboard/reviews-chart?from=2026-01-01&to=2026-01-31&place_id={{place_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","dashboard","reviews-chart"], "query": [ {"key": "from", "value": "2026-01-01"}, {"key": "to", "value": "2026-01-31"}, {"key": "place_id", "value": "{{place_id}}"} ] },
            "description": "Get reviews chart filtered by place"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 422', function () { pm.expect(pm.response.code).to.be.oneOf([200,422]); });"] } }]
        }
      ]
    },
    {
      "name": "Auth (continued)",
      "item": [
        {
          "name": "Me",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Accept", "value": "application/json" },
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{admin_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/admin/auth/me", "host": ["{{base_url}}"], "path": ["api","v1","admin","auth","me"] },
            "description": "Get current admin profile (protected)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Accept", "value": "application/json" },
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{admin_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/admin/auth/logout", "host": ["{{base_url}}"], "path": ["api","v1","admin","auth","logout"] },
            "description": "Logout admin (protected)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        }
      ]
    },
    {
      "name": "RBAC",
      "item": [
        {
          "name": "List Roles",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/roles", "host": ["{{base_url}}"], "path": ["api","v1","admin","roles"] },
            "description": "List roles (requires rbac.roles.manage permission)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        },
        {
          "name": "Create Role",
          "request": {
            "method": "POST",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"manager\"\n}" },
            "url": { "raw": "{{base_url}}/api/v1/admin/roles", "host": ["{{base_url}}"], "path": ["api","v1","admin","roles"] },
            "description": "Create a role (requires rbac.roles.manage). Saves {{role_id}}"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 201 or 200', function () { pm.expect(pm.response.code).to.be.oneOf([200,201]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","function findId(obj){ if(!obj||typeof obj!=='object') return null; if(obj.id) return obj.id; for(var k in obj){ if(obj.hasOwnProperty(k)){ var v = findId(obj[k]); if(v) return v; }} return null; }","var id = findId(json);","if(id) pm.collectionVariables.set('role_id', id);"] } }]
        },
        {
          "name": "Sync Permissions To Role",
          "request": {
            "method": "POST",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "body": { "mode": "raw", "raw": "{\n  \"permissions\": [\"catalog.categories.manage\", \"catalog.brands.manage\"]\n}" },
            "url": { "raw": "{{base_url}}/api/v1/admin/roles/{{role_id}}/sync-permissions", "host": ["{{base_url}}"], "path": ["api","v1","admin","roles","{{role_id}}","sync-permissions"] },
            "description": "Sync permissions for role (requires rbac.roles.manage)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        },
        {
          "name": "List Permissions",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/permissions", "host": ["{{base_url}}"], "path": ["api","v1","admin","permissions"] },
            "description": "List permissions (requires rbac.permissions.manage)"
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        }
      ]
    },
    {
      "name": "Catalog",
      "item": [
        {
          "name": "Categories",
          "item": [
            {
              "name": "List Categories",
              "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/categories", "host": ["{{base_url}}"], "path": ["api","v1","admin","categories"] }, "description": "List categories" },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "Create Category",
              "request": { "method": "POST", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Test Category\"\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/categories", "host": ["{{base_url}}"], "path": ["api","v1","admin","categories"] }, "description": "Create category and save {{category_id}}" },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 201 or 200', function () { pm.expect(pm.response.code).to.be.oneOf([200,201]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","function findId(obj){ if(!obj||typeof obj!=='object') return null; if(obj.id) return obj.id; for(var k in obj){ if(obj.hasOwnProperty(k)){ var v = findId(obj[k]); if(v) return v; }} return null; }","var id = findId(json);","if(id) pm.collectionVariables.set('category_id', id);"] } }]
            },
            {
              "name": "Get Category",
              "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/categories/{{category_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","categories","{{category_id}}"] }, "description": "Get single category by {{category_id}}" },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "Update Category",
              "request": { "method": "PUT", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Updated Category\"\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/categories/{{category_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","categories","{{category_id}}"] }, "description": "Update category" },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "Delete Category",
              "request": { "method": "DELETE", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/categories/{{category_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","categories","{{category_id}}"] }, "description": "Delete category" },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 204', function () { pm.expect(pm.response.code).to.be.oneOf([200,204]); });"] } }]
            }
          ]
        },
        {
          "name": "Subcategories",
          "item": [
            { "name": "List Subcategories", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/subcategories", "host": ["{{base_url}}"], "path": ["api","v1","admin","subcategories"] }, "description": "List subcategories" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Create Subcategory", "request": { "method": "POST", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Test Subcategory\",\n  \"category_id\": \"{{category_id}}\"\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/subcategories", "host": ["{{base_url}}"], "path": ["api","v1","admin","subcategories"] }, "description": "Create subcategory and save {{subcategory_id}}" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 201 or 200', function () { pm.expect(pm.response.code).to.be.oneOf([200,201]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","function findId(obj){ if(!obj||typeof obj!=='object') return null; if(obj.id) return obj.id; for(var k in obj){ if(obj.hasOwnProperty(k)){ var v = findId(obj[k]); if(v) return v; }} return null; }","var id = findId(json);","if(id) pm.collectionVariables.set('subcategory_id', id);"] } }] },
            { "name": "Get Subcategory", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/subcategories/{{subcategory_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","subcategories","{{subcategory_id}}"] }, "description": "Get single subcategory" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Update Subcategory", "request": { "method": "PUT", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Updated Subcategory\",\n  \"category_id\": \"{{category_id}}\"\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/subcategories/{{subcategory_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","subcategories","{{subcategory_id}}"] }, "description": "Update subcategory" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Delete Subcategory", "request": { "method": "DELETE", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/subcategories/{{subcategory_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","subcategories","{{subcategory_id}}"] }, "description": "Delete subcategory" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 204', function () { pm.expect(pm.response.code).to.be.oneOf([200,204]); });"] } }] }
          ]
        },
        {
          "name": "Brands",
          "item": [
            { "name": "List Brands", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/brands", "host": ["{{base_url}}"], "path": ["api","v1","admin","brands"] }, "description": "List brands" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Create Brand", "request": { "method": "POST", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Test Brand\"\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/brands", "host": ["{{base_url}}"], "path": ["api","v1","admin","brands"] }, "description": "Create brand and save {{brand_id}}" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 201 or 200', function () { pm.expect(pm.response.code).to.be.oneOf([200,201]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","function findId(obj){ if(!obj||typeof obj!=='object') return null; if(obj.id) return obj.id; for(var k in obj){ if(obj.hasOwnProperty(k)){ var v = findId(obj[k]); if(v) return v; }} return null; }","var id = findId(json);","if(id) pm.collectionVariables.set('brand_id', id);"] } }] },
            { "name": "Get Brand", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/brands/{{brand_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","brands","{{brand_id}}"] }, "description": "Get single brand" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Update Brand", "request": { "method": "PUT", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Updated Brand\"\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/brands/{{brand_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","brands","{{brand_id}}"] }, "description": "Update brand" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Delete Brand", "request": { "method": "DELETE", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/brands/{{brand_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","brands","{{brand_id}}"] }, "description": "Delete brand" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 204', function () { pm.expect(pm.response.code).to.be.oneOf([200,204]); });"] } }] }
          ]
        },
        {
          "name": "Places",
          "item": [
            { "name": "List Places", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/places", "host": ["{{base_url}}"], "path": ["api","v1","admin","places"] }, "description": "List places" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Create Place", "request": { "method": "POST", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Test Place\"\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/places", "host": ["{{base_url}}"], "path": ["api","v1","admin","places"] }, "description": "Create place and save {{place_id}}" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 201 or 200', function () { pm.expect(pm.response.code).to.be.oneOf([200,201]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","function findId(obj){ if(!obj||typeof obj!=='object') return null; if(obj.id) return obj.id; for(var k in obj){ if(obj.hasOwnProperty(k)){ var v = findId(obj[k]); if(v) return v; }} return null; }","var id = findId(json);","if(id) pm.collectionVariables.set('place_id', id);"] } }] },
            { "name": "Get Place", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/places/{{place_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","places","{{place_id}}"] }, "description": "Get single place" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Update Place", "request": { "method": "PUT", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Updated Place\"\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/places/{{place_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","places","{{place_id}}"] }, "description": "Update place" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Delete Place", "request": { "method": "DELETE", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/places/{{place_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","places","{{place_id}}"] }, "description": "Delete place" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 204', function () { pm.expect(pm.response.code).to.be.oneOf([200,204]); });"] } }] }
          ]
        },
        {
          "name": "Branches",
          "item": [
            { "name": "List Branches", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/branches", "host": ["{{base_url}}"], "path": ["api","v1","admin","branches"] }, "description": "List branches" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Create Branch", "request": { "method": "POST", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Test Branch\",\n  \"place_id\": \"{{place_id}}\"\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/branches", "host": ["{{base_url}}"], "path": ["api","v1","admin","branches"] }, "description": "Create branch and save {{branch_id}}" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 201 or 200', function () { pm.expect(pm.response.code).to.be.oneOf([200,201]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","function findId(obj){ if(!obj||typeof obj!=='object') return null; if(obj.id) return obj.id; for(var k in obj){ if(obj.hasOwnProperty(k)){ var v = findId(obj[k]); if(v) return v; }} return null; }","var id = findId(json);","if(id) pm.collectionVariables.set('branch_id', id);"] } }] },
            { "name": "Get Branch", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/branches/{{branch_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","branches","{{branch_id}}"] }, "description": "Get single branch" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Update Branch", "request": { "method": "PUT", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Updated Branch\",\n  \"place_id\": \"{{place_id}}\"\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/branches/{{branch_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","branches","{{branch_id}}"] }, "description": "Update branch" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Delete Branch", "request": { "method": "DELETE", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/branches/{{branch_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","branches","{{branch_id}}"] }, "description": "Delete branch" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 204', function () { pm.expect(pm.response.code).to.be.oneOf([200,204]); });"] } }] },
            { "name": "Regenerate Branch QR", "request": { "method": "POST", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/branches/{{branch_id}}/regenerate-qr", "host": ["{{base_url}}"], "path": ["api","v1","admin","branches","{{branch_id}}","regenerate-qr"] }, "description": "Regenerate QR for branch" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] }
          ]
        },
        {
          "name": "Rating Criteria",
          "item": [
            { "name": "List Rating Criteria", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/rating-criteria", "host": ["{{base_url}}"], "path": ["api","v1","admin","rating-criteria"] }, "description": "List rating criteria" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Create Rating Criteria", "request": { "method": "POST", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Cleanliness\",\n  \"is_active\": true\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/rating-criteria", "host": ["{{base_url}}"], "path": ["api","v1","admin","rating-criteria"] }, "description": "Create rating criteria and save {{criteria_id}}" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 201 or 200', function () { pm.expect(pm.response.code).to.be.oneOf([200,201]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","function findId(obj){ if(!obj||typeof obj!=='object') return null; if(obj.id) return obj.id; for(var k in obj){ if(obj.hasOwnProperty(k)){ var v = findId(obj[k]); if(v) return v; }} return null; }","var id = findId(json);","if(id) pm.collectionVariables.set('criteria_id', id);"] } }] },
            { "name": "Get Rating Criteria", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/rating-criteria/{{criteria_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","rating-criteria","{{criteria_id}}"] }, "description": "Get single rating criteria" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Update Rating Criteria", "request": { "method": "PUT", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"name_en\": \"Updated Cleanliness\",\n  \"is_active\": true\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/rating-criteria/{{criteria_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","rating-criteria","{{criteria_id}}"] }, "description": "Update rating criteria" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Delete Rating Criteria", "request": { "method": "DELETE", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/rating-criteria/{{criteria_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","rating-criteria","{{criteria_id}}"] }, "description": "Delete rating criteria" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 204', function () { pm.expect(pm.response.code).to.be.oneOf([200,204]); });"] } }] }
          ]
        },
        {
          "name": "Rating Criteria Choices",
          "item": [
            { "name": "List Choices", "request": { "method": "GET", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/rating-criteria/{{criteria_id}}/choices", "host": ["{{base_url}}"], "path": ["api","v1","admin","rating-criteria","{{criteria_id}}","choices"] }, "description": "List choices for a rating criteria" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Create Choice", "request": { "method": "POST", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"label\": \"Excellent\",\n  \"value\": 5\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/rating-criteria/{{criteria_id}}/choices", "host": ["{{base_url}}"], "path": ["api","v1","admin","rating-criteria","{{criteria_id}","choices"] }, "description": "Create choice for criteria and save {{choice_id}}" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 201 or 200', function () { pm.expect(pm.response.code).to.be.oneOf([200,201]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","function findId(obj){ if(!obj||typeof obj!=='object') return null; if(obj.id) return obj.id; for(var k in obj){ if(obj.hasOwnProperty(k)){ var v = findId(obj[k]); if(v) return v; }} return null; }","var id = findId(json);","if(id) pm.collectionVariables.set('choice_id', id);"] } }] },
            { "name": "Update Choice", "request": { "method": "PUT", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "body": { "mode": "raw", "raw": "{\n  \"label\": \"Good\",\n  \"value\": 4\n}" }, "url": { "raw": "{{base_url}}/api/v1/admin/rating-criteria/{{criteria_id}}/choices/{{choice_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","rating-criteria","{{criteria_id}}","choices","{{choice_id}}"] }, "description": "Update a choice" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }] },
            { "name": "Delete Choice", "request": { "method": "DELETE", "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ], "url": { "raw": "{{base_url}}/api/v1/admin/rating-criteria/{{criteria_id}}/choices/{{choice_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","rating-criteria","{{criteria_id}}","choices","{{choice_id}}"] }, "description": "Delete a choice" }, "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 204', function () { pm.expect(pm.response.code).to.be.oneOf([200,204]); });"] } }] }
          ]
        }
      ]
    }
    ,
    {
      "name": "04-Reviews Moderation",
      "item": [
        {
          "name": "List Reviews",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/reviews", "host": ["{{base_url}}"], "path": ["api","v1","admin","reviews"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Response shape', function(){ pm.expect(json).to.have.property('success'); pm.expect(json).to.have.property('data'); pm.expect(json).to.have.property('meta'); });"] } }]
        },
        {
          "name": "Get Review Details",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/reviews/{{review_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","reviews","{{review_id}}"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        },
        {
          "name": "Hide Review (hide)",
          "request": {
            "method": "POST",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "body": { "mode": "raw", "raw": "{\n  \"is_hidden\": true,\n  \"reason\": \"Spam\"\n}" },
            "url": { "raw": "{{base_url}}/api/v1/admin/reviews/{{review_id}}/hide", "host": ["{{base_url}}"], "path": ["api","v1","admin","reviews","{{review_id}}","hide"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        },
        {
          "name": "Hide Review (unhide)",
          "request": {
            "method": "POST",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "body": { "mode": "raw", "raw": "{\n  \"is_hidden\": false\n}" },
            "url": { "raw": "{{base_url}}/api/v1/admin/reviews/{{review_id}}/hide", "host": ["{{base_url}}"], "path": ["api","v1","admin","reviews","{{review_id}}","hide"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        },
        {
          "name": "Reply To Review",
          "request": {
            "method": "POST",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "body": { "mode": "raw", "raw": "{\n  \"reply_text\": \"Thank you, we'll improve\"\n}" },
            "url": { "raw": "{{base_url}}/api/v1/admin/reviews/{{review_id}}/reply", "host": ["{{base_url}}"], "path": ["api","v1","admin","reviews","{{review_id}}","reply"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        },
        {
          "name": "Mark Featured",
          "request": {
            "method": "POST",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "body": { "mode": "raw", "raw": "{\n  \"is_featured\": true\n}" },
            "url": { "raw": "{{base_url}}/api/v1/admin/reviews/{{review_id}}/mark-featured", "host": ["{{base_url}}"], "path": ["api","v1","admin","reviews","{{review_id}}","mark-featured"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        }
      ]
    }
  ,
    {
      "name": "06-Points & Settings",
      "item": [
        {
          "name": "Loyalty: List Settings",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/loyalty-settings", "host": ["{{base_url}}"], "path": ["api","v1","admin","loyalty-settings"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Response shape', function(){ pm.expect(json).to.have.property('success'); pm.expect(json).to.have.property('data'); pm.expect(json).to.have.property('meta'); });"] } }]
        },
        {
          "name": "Loyalty: Create Version",
          "request": {
            "method": "POST",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "body": { "mode": "raw", "raw": "{\n  \"points_per_review\": 10,\n  \"point_value_money\": 0.10,\n  \"currency\": \"EGP\"\n}" },
            "url": { "raw": "{{base_url}}/api/v1/admin/loyalty-settings", "host": ["{{base_url}}"], "path": ["api","v1","admin","loyalty-settings"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 201', function () { pm.expect(pm.response.code).to.be.oneOf([200,201]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","var id = json.data && json.data.id; if(id) pm.collectionVariables.set('loyalty_setting_id', id);"] } }]
        },
        {
          "name": "Loyalty: Activate Version",
          "request": {
            "method": "POST",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/loyalty-settings/{{loyalty_setting_id}}/activate", "host": ["{{base_url}}"], "path": ["api","v1","admin","loyalty-settings","{{loyalty_setting_id}}","activate"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
        },
        {
          "name": "Points: List Transactions",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/points/transactions", "host": ["{{base_url}}"], "path": ["api","v1","admin","points","transactions"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Response shape', function(){ pm.expect(json).to.have.property('success'); pm.expect(json).to.have.property('data'); pm.expect(json).to.have.property('meta'); });"] } }]
        },
        {
          "name": "Points: Get Transaction Detail",
          "request": {
            "method": "GET",
            "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/points/transactions/{{points_transaction_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","points","transactions","{{points_transaction_id}}"] }
          },
          "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 404', function () { pm.expect(pm.response.code).to.be.oneOf([200,404]); });"] } }]
        },
        {
          "name": "07-Notifications",
          "item": [
            {
              "name": "GET Templates",
              "request": {
                "method": "GET",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "url": { "raw": "{{base_url}}/api/v1/admin/notifications/templates", "host": ["{{base_url}}"], "path": ["api","v1","admin","notifications","templates"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Response shape', function(){ pm.expect(json).to.have.property('success'); pm.expect(json).to.have.property('data'); pm.expect(json).to.have.property('meta'); });"] } }]
            },
            {
              "name": "POST Create Template",
              "request": {
                "method": "POST",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "body": { "mode": "raw", "raw": "{\n  \"key\": \"promo_broadcast\",\n  \"type\": \"PROMO_BROADCAST\",\n  \"title_en\": \"Promo\",\n  \"title_ar\": \"\",\n  \"body_en\": \"Hello {{name}}\",\n  \"body_ar\": \" {{name}}\"\n}" },
                "url": { "raw": "{{base_url}}/api/v1/admin/notifications/templates", "host": ["{{base_url}}"], "path": ["api","v1","admin","notifications","templates"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 201', function () { pm.expect(pm.response.code).to.be.oneOf([200,201]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","var tid = json.data && json.data.id; if(tid) pm.collectionVariables.set('template_id', tid);"] } }]
            },
            {
              "name": "PUT Update Template",
              "request": {
                "method": "PUT",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "body": { "mode": "raw", "raw": "{\n  \"title_en\": \"Updated Promo\",\n  \"title_ar\": \" \",\n  \"body_en\": \"Hello {{name}} Updated\",\n  \"body_ar\": \" {{name}} \"\n}" },
                "url": { "raw": "{{base_url}}/api/v1/admin/notifications/templates/{{template_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","notifications","templates","{{template_id}}"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "POST Broadcast (custom)",
              "request": {
                "method": "POST",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "body": { "mode": "raw", "raw": "{\n  \"title_en\": \"Site Maintenance\",\n  \"title_ar\": \" \",\n  \"body_en\": \"We will be down tonight\",\n  \"body_ar\": \"  \",\n  \"audience\": { \"type\": \"all\" }\n}" },
                "url": { "raw": "{{base_url}}/api/v1/admin/notifications/broadcast", "host": ["{{base_url}}"], "path": ["api","v1","admin","notifications","broadcast"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Response shape', function(){ pm.expect(json).to.have.property('success'); pm.expect(json).to.have.property('data'); pm.expect(json.data).to.have.property('recipients_count'); });"] } }]
            },
            {
              "name": "POST Broadcast (template)",
              "request": {
                "method": "POST",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "body": { "mode": "raw", "raw": "{\n  \"template_id\": {{template_id}},\n  \"lang\": \"en\",\n  \"data\": { \"name\": \"User\" },\n  \"audience\": { \"type\": \"all\" }\n}" },
                "url": { "raw": "{{base_url}}/api/v1/admin/notifications/broadcast", "host": ["{{base_url}}"], "path": ["api","v1","admin","notifications","broadcast"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "POST Send To User (custom)",
              "request": {
                "method": "POST",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "body": { "mode": "raw", "raw": "{\n  \"title_en\": \"Hi\",\n  \"title_ar\": \"\",\n  \"body_en\": \"Hello\",\n  \"body_ar\": \"\"\n}" },
                "url": { "raw": "{{base_url}}/api/v1/admin/users/{{target_user_id}}/notifications", "host": ["{{base_url}}"], "path": ["api","v1","admin","users","{{target_user_id}}","notifications"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Response shape', function(){ pm.expect(json).to.have.property('success'); pm.expect(json).to.have.property('data'); });"] } }]
            },
            {
              "name": "POST Send To User (template)",
              "request": {
                "method": "POST",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "body": { "mode": "raw", "raw": "{\n  \"template_id\": {{template_id}},\n  \"lang\": \"en\",\n  \"data\": { \"name\": \"User\" }\n}" },
                "url": { "raw": "{{base_url}}/api/v1/admin/users/{{target_user_id}}/notifications", "host": ["{{base_url}}"], "path": ["api","v1","admin","users","{{target_user_id}}","notifications"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            }
          ]
        },
        {
          "name": "08-Invites",
          "item": [
            {
              "name": "GET Invites (no filters)",
              "request": {
                "method": "GET",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "url": { "raw": "{{base_url}}/api/v1/admin/invites", "host": ["{{base_url}}"], "path": ["api","v1","admin","invites"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Response shape', function(){ pm.expect(json).to.have.property('success'); pm.expect(json).to.have.property('data'); pm.expect(json).to.have.property('meta'); });"] } }]
            },
            {
              "name": "GET Invites (status filter)",
              "request": {
                "method": "GET",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "url": { "raw": "{{base_url}}/api/v1/admin/invites?status=pending", "host": ["{{base_url}}"], "path": ["api","v1","admin","invites"], "query": [{"key":"status","value":"pending"}] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "GET Invites (search q)",
              "request": {
                "method": "GET",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "url": { "raw": "{{base_url}}/api/v1/admin/invites?q=055", "host": ["{{base_url}}"], "path": ["api","v1","admin","invites"], "query": [{"key":"q","value":"055"}] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200', function () { pm.response.to.have.status(200); });"] } }]
            },
            {
              "name": "GET Invite Details",
              "request": {
                "method": "GET",
                "header": [ { "key": "Accept", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{admin_token}}" } ],
                "url": { "raw": "{{base_url}}/api/v1/admin/invites/{{invite_id}}", "host": ["{{base_url}}"], "path": ["api","v1","admin","invites","{{invite_id}}"] }
              },
              "event": [{ "listen": "test", "script": { "type": "text/javascript", "exec": ["pm.test('Status is 200 or 404', function () { pm.expect(pm.response.code).to.be.oneOf([200,404]); });","var json = {}; try { json = pm.response.json(); } catch(e) {}","pm.test('Detail fields', function(){ if(pm.response.code===200){ pm.expect(json.data).to.have.property('id'); pm.expect(json.data).to.have.property('status'); } });"] } }]
            }
          ]
        }
      ]
    }
  ]
}
